#########################################################################
model{
	C <- 100000
	# Truco de los ceros
	for (i in 1:N){
		zeroY[i] <- 0
		zeroZ[i] <- 0
		zeroT[i] <- 0
		
		zeroY[i] ~ dpois(phiY[i])
		zeroZ[i] ~ dpois(phiZ[i])
		zeroT[i] ~ dpois(phiT[i])
		
		# Distribuciones
		u[i] <- exp(-pow(y[i]/sY, -alphaY)) # Acumulada Y
		v[i] <- exp(-pow(z[i]/sZ, -alphaZ)) # Acumulada Z
		
		# Densidades
		fY[i] <- (alphaY / sY) * pow(y[i]/sY , -alphaY - 1) * u[i]
		fZ[i] <- (alphaZ / sZ) * pow(z[i]/sZ , -alphaZ - 1) * v[i]
		
		# Gumbel-Hougaard
		CYZ[i] <- pow(-log(u[i]), theta-1) * pow(-log(v[i]), theta-1) * (1/(u[i]*v[i])) * exp(-pow(pow(-log(u[i]),theta) + pow(-log(v[i]), theta),1/theta)) * (pow(pow(-log(u[i]),theta) + pow(-log(v[i]), theta), 2/theta-2) + (theta-1)*pow(pow(-log(u[i]),theta) + pow(-log(v[i]), theta), 1/theta-2))
		
		phiY[i] <- -log(fY[i]) + C
		phiZ[i] <- -log(fZ[i]) + C
		phiT[i] <- -log(fY[i] * fZ[i] * CYZ[i]) + C
	}

	# Aprioris PM10
	alphaY ~  dunif(0,10) 
	sY ~ dunif(0,200)

	# Aprioris O3
	alphaZ ~  dunif(0,10) 
	sZ ~ dunif(0,200) 
	
	# Apriori de la theta Gumbel-Hougaard
	theta ~ dunif(1,15)
}

data
list(y=c(383, 322, 343, 388, 326, 163, 106, 90, 941, 112, 213, 214, 920, 498, 667, 405, 548, 357, 331, 325, 100, 191, 205, 291, 465, 649, 1233, 461, 395, 453, 575, 994, 961, 562, 652, 424, 576, 647, 637, 575, 747, 484, 210, 309, 111, 154, 175, 327, 374, 259, 420, 527, 867, 379, 99, 103, 153, 162, 374, 243, 428, 487, 404, 588, 479, 263, 252, 267, 340, 218, 340, 236, 200, 337, 327, 429, 175, 226, 150, 186, 153, 203, 168, 241, 198, 335, 418, 476, 382, 186, 358, 120, 131, 122, 182, 265, 364, 302, 302, 208, 533, 693, 225, 200, 135, 199, 207, 310, 268, 238, 332, 233, 293, 126, 222, 145, 186, 185, 299, 386, 309, 239, 284, 394, 402, 248, 147, 128, 117, 126, 245, 461, 596, 393, 782, 959, 267, 194, 128, 110, 108, 121, 139, 169, 231, 156, 276, 159, 200, 159, 126, 146, 173, 177, 291, 338, 421, 229, 322, 400, 290, 179, 130, 119, 121, 177, 218, 216, 267, 365, 291, 350, 272, 525, 188, 120, 96, 120, 180, 186, 160, 148, 387, 147, 264, 199, 114, 89, 138, 381, 296, 569, 299, 300, 421, 518, 260, 265, 131, 151, 139, 219, 174, 292, 257, 266, 270, 258, 177, 126, 138, 150, 124, 269, 146, 614, 220, 174, 593, 273, 284, 135, 134, 115, 105, 134, 153, 191, 192, 190, 455, 198, 150, 111, 133, 181, 120, 153, 159, 217, 293, 281, 264, 174, 153, 143, 128, 142, 102, 175, 182, 707, 342, 476, 171, 431, 323, 118, 133, 119, 128, 126, 154, 199, 214, 196, 141, 180, 282, 128, 89, 125, 172, 140, 174, 282, 179, 207, 168, 136, 125, 153, 158, 147, 149, 129, 153, 292, 227, 158, 194, 147, 191, 88, 112, 81, 94, 94, 150, 200, 148, 146, 219, 202, 213, 121, 109, 65, 85, 114, 137, 141, 184, 166, 411, 217, 93, 105, 110, 74, 125, 131, 168, 230), z=c(250, 246, 264, 242, 277, 345, 292, 274, 284, 285, 227, 261, 278, 258, 202, 219, 245, 221, 220, 221, 279, 272, 209, 229, 264, 244, 219, 277, 243, 259, 261, 262, 258, 224, 287, 229, 207, 217, 215, 230, 268, 256, 218, 206, 235, 269, 208, 232, 219, 226, 266, 279, 214, 265, 234, 224, 214, 257, 223, 222, 193, 231, 208, 218, 239, 195, 233, 176, 247, 247, 226, 224, 198, 187, 207, 184, 256, 227, 228, 231, 198, 224, 182, 185, 220, 167, 207, 211, 197, 182, 185, 219, 218, 183, 176, 217, 186, 213, 198, 209, 230, 213, 182, 170, 188, 190, 176, 168, 152, 186, 160, 188, 213, 177, 193, 160, 160, 172, 156, 187, 187, 181, 146, 196, 170, 158, 148, 146, 163, 144, 169, 149, 133, 150, 158, 181, 164, 152, 139, 139, 163, 129, 127, 105, 141, 134, 158, 171, 164, 156, 149, 120, 134, 129, 130, 153, 154, 134, 141, 160, 184, 132, 117, 153, 142, 112, 135, 144, 148, 185, 172, 140, 157, 155, 133, 113, 141, 148, 125, 121, 139, 136, 154, 156, 166, 170, 125, 133, 111, 148, 149, 129, 106, 127, 158, 150, 166, 150, 112, 120, 124, 130, 143, 142, 119, 117, 165, 132, 153, 128, 126, 109, 125, 114, 172, 130, 115, 121, 126, 175, 174, 139, 120, 143, 120, 138, 111, 109, 114, 151, 161, 156, 128, 136, 106, 112, 125, 118, 118, 121, 121, 139, 151, 153, 160, 146, 136, 141, 138, 145, 125, 135, 129, 154, 190, 159, 165, 154, 141, 138, 121, 131, 102, 110, 136, 144, 120, 143, 190, 143, 142, 127, 146, 134, 119, 113, 116, 132, 136, 140, 179, 150, 126, 122, 130, 131, 135, 121, 115, 123, 139, 155, 133, 139, 119, 136, 123, 112, 102, 106, 97, 123, 135, 150, 147, 127, 126, 107, 112, 136, 145, 98, 110, 145, 136, 147, 154, 148, 142, 123, 137, 129, 119, 145), N=324)

inits
list(alphaY = 2.58, sY = 110.64, alphaZ = 2.48, sZ = 171.20, theta = 2.55)
list(alphaY = 1.16, sY = 135.16, alphaZ = 3.69, sZ = 156.27, theta = 5.01)
list(alphaY = 2.03, sY = 129.13, alphaZ = 4.89, sZ = 166.00, theta = 3.56)
list(alphaY = 2.67, sY = 119.94, alphaZ = 5.54, sZ = 140.22, theta = 1.82)
list(alphaY = 1.94, sY = 123.24, alphaZ = 5.38, sZ = 133.79, theta = 1.23)